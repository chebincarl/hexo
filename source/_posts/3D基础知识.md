---
layout: title
title: 3D基础知识
date: 2019-04-07 11:38:30
categories: Unity
tags: Unity5.X游戏开发指南
---
任何3D画面都是由两个基础部分组成的：观察者/摄像机和被观察物。

<!--more-->

# Camera摄像机

{% asset_img 1.png %}

摄像机的参数如下表所示。

## 摄像机参数

| 参数  | 说明  |
| :------------ | :------------ |
| Clear Flags  | 清除标记。决定屏幕的哪部分将被清除。该项一般用于使用多台摄像机来描绘不同游戏对象的情况。<br>□ Skybox：天空盒。该模式为默认设置，在屏幕中空白的部分将显示当前摄像机的天空盒。如果当前摄像机没有设置天空盒，它会默认使用背景色。<br>□ Solid Color：纯色。选择该模式后，屏幕上的空白部分将显示当前摄像机的背景色。<br>□ Depth Only：深度相机，只渲染采集到的画面。<br>□ Don't Clear：不清除，每帧渲染画面叠加在上一帧画面之上。  |
| Background  | 背景颜色  |
| Culling Mask  | 剔除遮罩。摄像机将看到勾选的层，忽略未被勾选的层  |
| Projection  | 投射方式。<br>□ Perspective：透视。摄像机以透视方式渲染画面，拍摄区域是一个截锥体。<br>□ Orthographic：正交。摄像机以正交方式渲染画面，拍摄区域是一个长方体。  |
| Field of View  | 透视模式的视野范围  |
| Size  | 正交模式摄像机视口大小  |
| Clipping Planes  | 剪裁平面。<br>□ Near：近点。可视区域距离摄像机最近的点<br>□ Far：可视区域距离摄像机最远的点  |
| Viewport Rect  | 视口矩形。决定摄像机画面显示在屏幕的区域。参数X、Y决定区域起点，W、H决定区域宽高。屏幕坐标系是左下角为原点X=0，Y=0，屏幕最上方Y=1，屏幕最右方X=1。例如X=0，Y=0，W=1，H=1（默认）表示画面显示于整个屏幕。X=0.5，Y=0，W=0.5，H=1表示画面显示于右半屏幕。  |
| Depth  | 该项用于控制多个摄像机的渲染优先级，数值越大优先级越高。优先级高的摄像机拍摄的画面将覆盖在优先级低的摄像机的画面上  |
| Rendering Path  | 渲染路径。该项用于指定摄像机的渲染方法。<br>□ Use Graphics Settings：摄像机将使用设置的渲染方法，即Project Settings下Graphics中的设置。<br>□ Forward：快速渲染。摄像机将对所有游戏对象将按每种材质一个通道的方式来渲染。<br>□ Deferred：延迟光照。摄像机先对所有游戏对象进行一次无光照渲染，再进行光照渲染。<br>□ Legacy Vertex Lit：旧的顶点光照。摄像机将对所有的游戏对象作为顶点光照对象来渲染。<br>□ Legacy Deferred（light prepass）：旧的延迟光照。  |
| Target Texture  | 目标纹理。将摄像机画面输出到一张贴图而不是屏幕，可用于实现画中画或者画面特效  |
| Occlusion Culling  | 是否删除物体背向摄像机的部分  |
| HDR  | 高动态光照渲染。该项用于启用摄像机的高动态范围渲染功能。因为人眼对低范围的光照强度更为敏感，所以使用高动态范围渲染能够让场景更为真实，光照的变化不会显得太突兀  |

## 摄像机投射

** 1.透视摄像机 **

透视摄像机所能看到的是一个截锥体。如下图所示。

{% asset_img 2.png %}

离相机最近的截平面由上表中的Clipping Planes里的Near参数决定，数值代表的是距离摄像机原点的距离。Far参数决定的是最远的截平面，而Field of View决定截锥体的宽度。所以，和真实的人眼或摄像机不同，3D引擎中的摄像机并不是真正的无限视距，只能看到截锥体以内的物体。

Field of View是透视摄像机的视野范围，默认值是60，改变此值观察截锥体形状的变化。值越小，截锥体越窄，视野范围越小；值越大，截锥体越宽，视野范围越大。再改变Clipping Planes的Near和Far，并观察截锥体的变化。

** 2.正交摄像机 **

正交摄像机所能看到的是一个长方体，如下图所示。

{% asset_img 3.png %}

调整Size和Clipping Planes的Near和Far并观察长方体的变化。

# 3D模型

介绍了观察者摄像机，下面来讲解被观察物，也就是3D模型。无论是人物、场景还是特效粒子系统等，归根结底都是3D模型。

## Mesh网格模型

首先点击主菜单栏->Assets->Import Package->Characters，将此资源包导入工程。将Constructer拖入场景，然后点击Scene标签下的Shaded按钮，选择渲染模式为Wireframe，如下图所示。

{% asset_img 4.png %}

{% asset_img 5.png %}

观察此模式下的人物，大腿部分会看得最清楚。人物模型是由一个个三角形组成的，这种模型叫Mesh网格模型，如下图所示，3D Max、Maya等做出来的均是网格模型。在Project窗口中展开Constructer文件，白色网格覆盖的圆筒图标代表的是网格模型，construction_worker就是此人物的网格模型。

{% asset_img 6.png %}

## Texture贴图

有了网格模型，我们还需要知道物体表面的颜色。将所有模型表面画到一张图片上，如下图所示，这类图片叫作Texture贴图。

{% asset_img 7.png %}

但是我们还不知道网格模型是如何与贴图对应的，所以网格模型需要额外的信息，首先贴图的坐标规定为（x，y），x和y的范围都是[0，1]。<span style="color:red;">网格模型上每一个三角形顶点都对应着贴图上的一个坐标，那么每一个三角形的中间部分可以通过对该三角形所有顶点插值得到贴图里的颜色。</span>

## Material材质

尽管是近似的灰色，但灰色T恤衫和不锈钢是那么地不相同，因为它们对光照的反应不一样。T恤衫是由纺织物编织而成的，表面是凹凸起伏的，属于漫反射；而不锈钢的表面很平滑，属于镜面反射。

Material材质就是定义物体表面信息的，而物理信息通过Shader渲染器定义，如下图所示。Inspector窗口的第二栏Shader显示此材质使用的是Bumped Specular这个Shader。Unity自带了很多Shader，标准Shader适用范围很广，你也可以自己编写Shader。有兴趣的读者可以在熟练使用Unity后自己去学习这部分内容，推荐从Nvidia的《CG教程：可编程实时图形权威指南》开始入手。

{% asset_img 8.png %}

在Project窗口下找到球体图标的constructor_done，这就是材质，在三维建模工具或3D引擎里，通常默认以球体网格模型来展示材质，所以材质也叫材质球。把贴图装在材质上与网格模型对应。我们有了人物的几何信息、表面颜色信息和物理光照信息，就可以显示比较真实的人物模型了。

## 对应组件

网格模型、贴图、材质就是3D物体的基本组成部分。在游戏对象上添加相关组件来使用它们。<span style="color:red;">如果使用了骨骼动画，那么就是Skinned Mesh Renderer组件，</span>如下图所示，在Materials栏指定所使用的材质，在Mesh栏指定所使用的网格模型。

{% asset_img 9.png %}

如果没有使用骨骼动画，那么使用Mesh Filter组件指定网格模型，使用Mesh Renderer组件指定材质，如下图所示。

{% asset_img 10.png %}

## 骨骼动画

重要的是，我们还需要让人物能够动起来。人体是由骨骼链接的，如下图所示，骨骼信息包含在网格模型文件里。有了骨骼信息，我们可以播放人物动画让人物动起来。Constructor下的idle、jump_pose、run、walk都是Animation动画。

{% asset_img 11.png %}

# 习题
1.Unity的摄像机分为哪两种类型？
2.简述模型、贴图、材质三者的关系。
3.从网上下载一个人物模型并导入Unity，然后用4个摄像机分别从4个不同的角度观察人物并显示在屏幕的左上、左下、右上、右下4个区域。