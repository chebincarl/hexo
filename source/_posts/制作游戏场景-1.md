---
layout: title
title: 制作游戏场景-1
date: 2019-04-02 11:34:02
categories: Unity
tags: Unity5权威讲解
---
思考并回答以下问题：
1.用作纹理的图片分辨率要遵守什么规则？如何调整分辨率？
2.如何设置纹理平铺？
3.高度图和放射是什么？
4.遮挡贴图是干嘛用的？

<!--more-->

# 3D模型

制作游戏场景时，最先要制作的就是地面（Floor）。如果没有适合的3D模型，可以使用Unity 自带的原始模型（Primitive Mesh）中的Plane或者Cube。在此将使用Quad模型。Quad模型是由2个三角形（Triangle）和4个顶点（Vertex）构成的简单3D模型。

> Unity提供的Quad原始模型

{% asset_img 1.png %}

Quad是为了制作2D模型而添加的模型，已经以X轴为基准旋转了90°。

选定Quad后，设置Transform组件的Position、Rotation、Scale属性。

| Transform属性  | X  | Y  | Z  |
| :------------ | :------------ | :------------ | :------------ |
| Position  | 0  | 0  | 0  |
| Rotation  | 90  | 0  | 0  |
| Scale  | 50  | 50  | 1  |

将存放在Scene视图的所有游戏对象的名称均替换为直观的名称。例如，刚才制作的对象是地面，所以将其重命名为Floor。

** 设置游戏对象的Transform Position X、Y、Z原点 **

在Scene视图中创建游戏对象后，首先将其Transform组件的Position属性值设为（0, 0, 0），然后再放到合适的位置。游戏中，将Floor的Y轴坐标设置为0会对计算坐标很有帮助。假设某个模型的Y坐标大于0，则可直接导出以地面为基准时该模型的地上位置。

# 纹理

纹理（Texture）是3D模型表面的图像文件，为3D模型附上纹理就像给人体模型穿上各种衣服一样。Unity支持PSD、PNG、JPEG、TIFF、GIF、BMP、TGA等各种格式图像文件，对于Photoshop的格式PSD，Unity会另外自动展平（Flatten）PSD文件的各种图层。

Unity还支持在保存纹理原文件的情况下，对其进行压缩后再使用，这样可以减少资源消耗。

用作纹理的图像文件的分辨率长宽均为2n（...，16×16，32×32，64×64，128×128，256×256，...）时，Unity对其压缩的速度最快。特别是对于移动平台，要想提高速度，就必须使用分辨率长宽均为2n（power of two，POT）的纹理文件。

在Project视图中选择Images/Metal textures pack/pattern 10/diffuse菜单，可以查询Inspector视图的纹理的详细信息，或为其设置属性。

> 纹理的详细信息

{% asset_img 2.png %}

上图中，Inspector视图下方的预览区域会显示纹理的图像和分辨率、使用的压缩算法以及纹理文件大小。该图中所选的diffuse纹理分辨率为1024×1024，文件大小为1.3MB。因此，如果使用其制作移动平台的版本，必须适当减小分辨率。将该纹理的Max Size设置为256，然后点击Apply按钮，可以看到纹理的文件大小变为85.4KB。

> 调节分辨率以适应移动平台

{% asset_img 3.png %}

# 材质

将纹理用作3D模型表面的图像文件后，还需要一种媒介联系3D模型与纹理\-\-材质（Material）。材质用于设置3D模型的纹理的各种属性，即设置“是何种纹理、纹理间隙多少、模型表面的材质特性如何表现”等。

> 材质的作用

{% asset_img 4.png %}

# 应用纹理

Unity中应用纹理的方法有两种。第一种，导入纹理文件后，将Project视图中的纹理直接施放到Scene视图中的目标模型，则相应纹理文件夹中会自动生成材质文件，新生成的材质名称与纹理的文件名相同。

这虽然是应用纹理的最简单的方法，但并不建议各位使用。因为如果纹理和材质分散在各个文件夹，那么项目逐渐庞大后就很难管理。因此，建议各位使用方法二\-\-创建材质并为其设置属性。

在Project视图的Images文件夹下创建子文件夹Materials。右击Materials并在菜单中选择Create->Material，或者在Project视图中点击Create栏的Material，即可创建新材质。创建后，将该材质重命名为Floor。

下面为Floor材质指定纹理。选定该材质，在Inspector视图中查看其属性。如下图所示，选定Floor之后，将纹理图像文件夹中的Metal textures pack/patter 10/diffus纹理拖曳到Inspector视图中的Albedo插槽、将Normal纹理拖曳到Normal Map插槽即可。设置完成后，可以通过底部预览区域查看Sphere模型附上纹理之后的效果。

{% asset_img 5.png %}

除了从Project视图中拖曳纹理之外，也可以点击Inspector视图中各贴图插槽旁边的圆形图标，直接浏览并选择纹理。点击圆形图标后，IDE会打开Select Texture窗口，显示现阶段导入Project视图的所有纹理。

** 纹理插槽中对应的纹理预览放大功能 **

Inspector视图中的着色器（shader）选择的是标准（Standard）着色器时，因为各插槽当前选定的纹理预览区域很小，所以肉眼很难确认。此时可以按住Ctrl键，鼠标左键单击纹理插槽，即可放大显示对应纹理。

{% asset_img 6.png %}

设定纹理后，将材质应用于游戏对象。将Floor材质直接拖曳到Scene视图的Floor游戏对象上即可。 

材质可以将纹理像浴室瓷砖一样反复复制，此处将Floor材质的Tiling属性的X，Y值设定为（10,10）即可。也就是说，将一张纹理向X轴复制10次，向Y轴复制10次。

** 材质的预览功能 **

Inspector视图中，可以在材质属性等信息底部预览窗口中预览材质，并点击该窗口顶部实现最大化/最小化。此外，鼠标右击预览窗口顶部，则预览窗口从Inspector视图分离，另外打开新窗口以供预览。

点击Preview视图右上角的工具按钮，可以将已经附上纹理的球形（Sphere）模型转换为立方体（Cube ）、圆柱体（Cylinder）或圆环（Donut）模型。可以自行选择与纹理匹配的模型种类。

# 着色器以及基于物理的着色

着色器用于渲染材质上的纹理，决定着材质的观感。着色器编程根据开发库的不同（DirectX、OpenGL等）而使用不同语言，要想涉及该领域就需要具备非常专业的知识，还要了解很多3D图像的基础理论。下面介绍如何使用着色器。

Unity环境下，即使没有关于着色器编程的知识或经验，也可以轻松使用其内置着色器。特别是Unity 5首次提供了基于物理的着色（Physically-Based Shading，PBS），该着色方式以物体具备的固有特征为基础表现材质，将现实中存在的石头、树木、玻璃、塑料、金属等材质感用一个着色器表现出来。 Unity 5重新设计了着色器，代替其历史版本中使用的多种着色器。当然，为了向下兼容，Unity4.x版本的着色器在Unity 5中被重命名为Legacy Shaders。

Unity 5的基础着色器\-\-标准着色器为基于物理的着色提供了多种可详细设置的选项，其中比较重要的属性如下所示。

# 渲染模式

渲染模式（Rendering Mode）可以设置为Opaque（不透明），Cutout（镂空效果），Fade（渐变效果）和Transparent（透明）等4种值，展现各种材质感。

{% asset_img 7.png %}

> 渲染模式选项

| 选项  | 含义  |
| :------------ | :------------ |
| Opaque  | 默认值，显示为不透明纹理，运用于没有任何透明部分的Solid对象  |
| Cutout  | 同时显示不透明部分和透明部分，适用于草、镂空等效果  |
| Transparent  | 显示透明的塑料或玻璃等材质  |
| Fade  | 将具有透明属性值的模型渐隐，设为该值时可以处理渐隐/渐显的动画。因为可以渐隐不透明对象，故可用于构建全息效果  |

## 反照率

反照率（Albedo）指反射光的程度，也可以称为反射率，是为了呈现Unity 5新引入的基于物理的着色而添加的纹理。其原理为“现实中所有物体的光照反射率均不相同”。

> 反照率纹理插槽

{% asset_img 8.png %}

## 金属

金属（Metallic）是表现物体表面金属材质感的纹理，此纹理插槽旁边的Slide值越接近1，该纹理的表现就越接近金属材质。

{% asset_img 15.png %}

## 法线贴图
    
法线贴图（Normal Map）是显示模型表面曲线的一种特殊纹理，无需使用多个多边形（Polygon）即可显示精细的曲面效果。法线贴图纹理插槽右边的属性值越大，阴影效果就越粗糙。

> 法线贴图纹理插槽和阴影属性

{% asset_img 9.png %}

## 高度图

高度图（Height Map）是使用纹理表现模型高低的一种方式，以便在游戏中表现地形（Terrain）。为其设置纹理文件后即可生效，并可以为其设置突出的高度。

{% asset_img 10.png %}

## 遮挡贴图

遮挡贴图（Occlusion）使用黑白纹理，利用间接光照产生的明暗度增强物体的立体感和深度。用于遮挡的贴图纹理一般从3D模型工具或第三方工具获取。

{% asset_img 16.png %}

## 放射

放射（Emission）指对应的纹理可以自己作为发射光源，更改其后的属性值，界面就会显示可以设置光源强度和光源颜色的选项。另外，该插槽下面会出现设置全局光照的选项。

{% asset_img 11.png %}

## 细节遮蔽

细节遮蔽（Detail Mask）用于设置二次贴图，一般用于只表现特定部分细节的纹理。

{% asset_img 12.png %}

## 表现地面阴影\-\-使用法线贴图

下面修改先前用于地面模型的标准着色器的具体选项设置，以表现地面上的曲线。首先在Project视图中选择地面材质，并在法线贴图插槽中设置纹理文件为Images/Metal textures pack/pattern 10/normal。

在地面模型中使用法线贴图后，可以清楚地看到阴影，如下图所示。

{% asset_img 13.png %}

{% asset_img 14.png %}