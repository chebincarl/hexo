---
layout: title
title: 光照贴图的烘焙和使用
date: 2019-02-20 22:30:26
tags: Unity
---
光影效果在游戏中是十分重要的。在游戏的开发过程中需要加入很多种光源来提高游戏画面质感，但是若是每次都实时地计算物体根据灯光产生的阴影明显是不明智的。由于大多数阴影都是不变的，或许可以通过某种手段使这些不变的阴影固化在场景中，这样就省去了很多不必要的计算。

光照贴图就是用来解决这类问题的。它的基本原理就是使用一张包含有场景中不会变化的物体的阴影的贴图，附加在整个场景中，这样就制作出了相似度非常高的“假阴影”。注意，这样产生的假阴影是不根据光源和物体的位置变化而变化的，所以只适用于场景中不会运动形变的物体，如建筑、雕塑等。

<!--more-->

# 对场景进行光照烘焙

(1)首先搭建一个简单的场景，该场景包含若干3D游戏对象，以及一个Plane作为地板。将每个3D物体勾选为“Lightmap Static”，如下图所示。

{% asset_img 1.png %}

(2)创建一个平行光光源（用于产生阴影），在光源上的Light组件中将Mode属性选为Baked，并开启阴影，如下图所示。

{% asset_img 2.png %}

(3)接下来Window->Lighting->Settings打开光照烘焙窗口，有关于光照烘焙的所有参数的设置都可以在该窗口中完成。

(4)开始烘焙前，请检查场景中的3D物体是否都是Lightmap Static模式，光源的Light组件中的Mode是否设置为Baked。确认无误后在新打开的Lighting窗口中的Scene面板中单击下方的Generate Lighting按钮就可以对场景进行烘焙了，注意这时使用的都是默认的光照烘焙参数。注意将按钮旁边的Auto Generate（自动烘焙）开关关闭。

{% asset_img 3.png %}

(5)等待烘焙结束后，场景中会自动应用烘焙好的光照贴图。这时可以发现，即使将场景中的灯光关闭，在地面上依旧可以看到阴影。若是把产生阴影的物体挪开，则会发现地上的阴影并没有根据物体的位置改变而改变位置。这是因为阴影已经固化到场景中了，类似于纹理图。

{% asset_img 4.png %}

如果选中了Auto Generate复选框，将会自动烘焙。但是如果场景中元素很多，可能会造成卡顿，因此不建议开启。